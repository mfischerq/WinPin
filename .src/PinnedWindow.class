' Gambas class file

Private _geometry As WindowGeometry
Private _wmClass As WindowClass
Private _pinFirstWindowOnly As Boolean

Property Read WmClass As WindowClass
Property Read Geometry As WindowGeometry
Property PinFirstWindowOnly As Boolean

Public Procedure _new(Optional wmClass As WindowClass, Optional geometry As WindowGeometry)
    If IsMissing(WmClass) Then Return 
    _wmClass = wmClass
    _geometry = geometry
    _pinFirstWindowOnly = False
End

Private Function WmClass_Read() As WindowClass
    Return _wmClass
End

Private Function Geometry_Read() As WindowGeometry
    Return _geometry
End

Private Function PinFirstWindowOnly_Read() As Boolean
    Return _pinFirstWindowOnly
End

Private Sub PinFirstWindowOnly_Write(Value As Boolean)
    _pinFirstWindowOnly = Value
End

Public Function ToString() As String
    Return Subst("&1 &2", _wmClass.ToString(), _geometry.ToString())
End

Public Procedure _compare(Other As PinnedWindow) As Integer
    Return _wmClass._compare(Other.WmClass)
End

Public Procedure _write(outputStream As Stream)
    Write #outputStream, _geometry As Object
    Write #outputStream, _wmClass As Object
    Write #outputStream, _pinFirstWindowOnly As Boolean
End

Public Procedure _read(inputStream As Stream)
    _geometry = Read #inputStream As WindowGeometry
    _wmClass = Read #inputStream As WindowClass
    _pinFirstWindowOnly = Read #inputStream As Boolean
End 
